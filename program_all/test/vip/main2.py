import requests
from bs4 import BeautifulSoup
import pandas as pd
import re
import time

def fetch_review_count(wr_id: str) -> int:
    url = "https://vipgunma.com/bbs/rev.php"
    headers = {
        "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8",
        "Accept": "application/json, text/javascript, */*; q=0.01",
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36",
        "X-Requested-With": "XMLHttpRequest",
        "Origin": "https://vipgunma.com",
        "Referer": f"https://vipgunma.com/bbs/board.php?bo_table=gm_1&wr_id={wr_id}"
    }
    data = {
        "request": "requestRev",
        "page": 1,
        "wr_id": wr_id
    }

    try:
        res = requests.post(url, headers=headers, data=data)
        if res.status_code == 200:
            json_data = res.json()
            if json_data.get("result_code") == "success":
                return json_data.get("result_data", {}).get("total", 0)
    except Exception as e:
        print(f"[{wr_id}] 리뷰 수 요청 실패: {e}")

    return 0


# ✅ 수집된 wr_id 리스트 입력
wr_id_list = ['48977',
              '52152',
              '7322',
              '49552',
              '6741',
              '50503',
              '52161',
              '52365',
              '5138',
              '51857',
              '48967',
              '50476',
              '52435',
              '52386',
              '52180',
              '52228',
              '52537',
              '51255',
              '50045',
              '1525',
              '2785',
              '52270',
              '50110',
              '52343',
              '50794',
              '6505',
              '49259',
              '49315',
              '51553',
              '51601',
              '52530',
              '49716',
              '51412',
              '52074',
              '51511',
              '50124',
              '49429',
              '50907',
              '52583',
              '51570',
              '6673',
              '49339',
              '51768',
              '6807',
              '50266',
              '50851',
              '52520',
              '52079',
              '51510',
              '5015',
              '51542',
              '50706',
              '51562',
              '49331',
              '51254',
              '51083',
              '49605',
              '13141',
              '52241',
              '52585',
              '49327',
              '48949',
              '3207',
              '51652',
              '52297',
              '50958',
              '51048',
              '49322',
              '49714',
              '20101',
              '50626',
              '51271',
              '2974',
              '52493',
              '17766',
              '50600',
              '3709',
              '52414',
              '71',
              '51099',
              '51725',
              '52066',
              '51623',
              '52272',
              '52346',
              '7357',
              '4422',
              '2971',
              '17415',
              '50784',
              '3751',
              '51247',
              '49780',
              '50620',
              '49214',
              '1178',
              '51972',
              '51803',
              '49061',
              '51241',
              '52201',
              '49356',
              '49640',
              '49352',
              '50915',
              '50630',
              '3294',
              '51421',
              '2001',
              '49404',
              '52176',
              '49146',
              '7414',
              '52428',
              '49022',
              '49546',
              '50521',
              '50739',
              '2510',
              '52147',
              '52508',
              '52269',
              '52306',
              '3028',
              '49545',
              '49700',
              '49196',
              '4976',
              '52301',
              '49466',
              '50311',
              '49544',
              '52503',
              '51836',
              '52594',
              '52285',
              '52397',
              '49570',
              '52563',
              '51834',
              '52284',
              '51212',
              '49399',
              '51574',
              '49395',
              '50588',
              '5224',
              '51265',
              '49749',
              '49736',
              '52418',
              '2602',
              '52419',
              '49147',
              '51556',
              '39741',
              '50566',
              '49614',
              '51372',
              '52239',
              '52506',
              '864',
              '49059',
              '597',
              '50973',
              '52567',
              '50898',
              '52098',
              '50702',
              '52420',
              '49180',
              '4424',
              '50860',
              '49690',
              '49438',
              '50296',
              '50136',
              '49115',
              '2905',
              '52106',
              '51882',
              '3263',
              '51146',
              '6564',
              '24961',
              '52003',
              '50185',
              '51310',
              '52214',
              '50394',
              '51503',
              '50376',
              '51583',
              '5902',
              '49606',
              '2820',
              '5141',
              '52065',
              '51543',
              '50418',
              '49751',
              '49725',
              '50184',
              '51628',
              '52203',
              '48903',
              '6529',
              '50628',
              '50504',
              '5992',
              '49324',
              '51653',
              '51945',
              '49914',
              '3388',
              '7187',
              '52391',
              '3544',
              '52572',
              '50780',
              '50996',
              '5054',
              '51830',
              '52200',
              '52070',
              '51482',
              '51485',
              '50123',
              '52173',
              '51200',
              '52101',
              '51948',
              '50598',
              '50410',
              '5987',
              '52083',
              '52516',
              '51100',
              '50048',
              '51544',
              '50782',
              '50335',
              '51131',
              '52268',
              '6026',
              '3565',
              '3279',
              '51109',
              '3991',
              '52570',
              '50737',
              '49703',
              '52550',
              '52216',
              '50294',
              '2968',
              '50874',
              '51502',
              '50293',
              '7588',
              '1095',
              '51258',
              '51257',
              '52534',
              '50783',
              '5220',
              '3093',
              '51917',
              '12863',
              '49167',
              '49101',
              '49748',
              '4755',
              '50337',
              '4713',
              '51614',
              '6283',
              '52576',
              '3350',
              '49076',
              '50436',
              '52311',
              '49206',
              '52579',
              '50941',
              '49422',
              '49613',
              '5035',
              '49812',
              '52137',
              '5162',
              '52408',
              '52315',
              '52064',
              '50984',
              '7199',
              '49077',
              '51984',
              '2825',
              '52227',
              '49169',
              '15719',
              '50632',
              '49705',
              '51326',
              '49368',
              '3925',
              '50606',
              '50926',
              '52582',
              '50627',
              '51749',
              '51068',
              '7384',
              '51539',
              '4269',
              '52454',
              '50527',
              '50624',
              '49442',
              '50551',
              '50647',
              '48974',
              '4266',
              '52194',
              '2489',
              '50465',
              '52342',
              '49109',
              '36171',
              '50843',
              '51937',
              '52316',
              '51128',
              '50174',
              '51232',
              '2930',
              '6097',
              '48964',
              '51860',
              '52448',
              '51802',
              '49848',
              '51705',
              '52500',
              '25712',
              '49353',
              '52022',
              '51090',
              '50143',
              '1626',
              '2549',
              '51476',
              '52588',
              '52424',
              '52532',
              '51842',
              '1499',
              '52569',
              '5814',
              '51700',
              '51985',
              '2664',
              '51656',
              '51244',
              '50816',
              '51928',
              '52056',
              '52404',
              '51657',
              '29666',
              '50908',
              '1660',
              '49512',
              '51913',
              '51525',
              '52057',
              '51954',
              '48952',
              '11497',
              '49679',
              '52512',
              '1473',
              '49096',
              '52374',
              '6335',
              '6351',
              '2321',
              '52328',
              '6898',
              '52370',
              '3839',
              '2666',
              '50279',
              '50815',
              '49228',
              '49757',
              '4098',
              '6948',
              '48924',
              '48986',
              '3528',
              '49173',
              '49083',
              '52337',
              '49896',
              '2762',
              '2175',
              '52028',
              '49233',
              '49295',
              '49730',
              '52400',
              '52542',
              '2565',
              '52162',
              '50425',
              '5488',
              '51560',
              '52509',
              '51740',
              '3368',
              '52141',
              '51296',
              '52258',
              '52024',
              '52373',
              '52362',
              '49994',
              '2550',
              '49054',
              '48990',
              '48941',
              '51491',
              '49177',
              '51355',
              '49577',
              '51199',
              '52344',
              '5500',
              '49525',
              '52488',
              '7067',
              '51472',
              '49092',
              '51307',
              '51774',
              '1327',
              '51468',
              '4862',
              '2635',
              '49297',
              '52233',
              '51764',
              '49643',
              '1589',
              '52136',
              '2596',
              '3636',
              '2850',
              '1985',
              '50774',
              '52061',
              '51551',
              '51791',
              '52564',
              '2022',
              '49135',
              '2592',
              '52274',
              '51229',
              '50372',
              '51667',
              '49480',
              '52553',
              '1195',
              '51691',
              '51448',
              '49310',
              '52586',
              '52358',
              '2311',
              '50540',
              '52231',
              '2997',
              '51760',
              '34691',
              '52591',
              '52547',
              '6955',
              '51113',
              '50153',
              '3640',
              '50944',
              '995',
              '51084',
              '51854',
              '4039',
              '51908',
              '51905',
              '51907',
              '52388',
              '52105',
              '52059',
              '52483',
              '2486',
              '50590',
              '50361',
              '50414',
              '2941',
              '50563',
              '51540',
              '51979',
              '52487',
              '50895',
              '52046',
              '50795',
              '52598',
              '51904',
              '51734',
              '6356',
              '7165',
              '52376',
              '50034',
              '50105',
              '2016',
              '49717',
              '49265',
              '49383',
              '51811',
              '2548',
              '49311',
              '48957',
              '50260',
              '51449',
              '51835',
              '49694',
              '50423',
              '51943',
              '49020',
              '52377',
              '49829',
              '50357',
              '51671',
              '51514',
              '52296',
              '6288',
              '52120',
              '51222',
              '2074',
              '49681',
              '6523',
              '51897',
              '2119',
              '4190',
              '51111',
              '49435',
              '52077',
              '49593',
              '52289',
              '49243',
              '51616',
              '51736',
              '49004',
              '2745',
              '51499',
              '51595',
              '52565',
              '50848',
              '50946',
              '49002',
              '52008',
              '51082',
              '52307',
              '51353',
              '49254',
              '434',
              '49443',
              '2936',
              '52303',
              '51351',
              '52581',
              '52142',
              '50548',
              '50510',
              '50581',
              '52063',
              '4014',
              '52002',
              '52595',
              '51273',
              '46735',
              '51807',
              '52395',
              '51746',
              '5193',
              '51038',
              '50858',
              '2591',
              '50290',
              '50938',
              '2512',
              '51914',
              '52211',
              '2249',
              '3570',
              '52421',
              '51429',
              '52412',
              '49122',
              '50912',
              '6360',
              '2047',
              '4056',
              '49168',
              '1632',
              '1998',
              '49625',
              '2141',
              '52522',
              '50633',
              '5006',
              '36935',
              '52210',
              '52041',
              '2385',
              '3345',
              '52187',
              '52338',
              '2795',
              '51422',
              '51438',
              '52251',
              '4923',
              '50724',
              '50614',
              '52292',
              '49365',
              '7616',
              '52469',
              '49260',
              '51577',
              '51903',
              '52519',
              '2979',
              '52440',
              '50011',
              '51890',
              '2904',
              '51516',
              '50276',
              '50439',
              '50924',
              '51467',
              '51865',
              '49607',
              '52396',
              '50412',
              '50594',
              '51250',
              '44948',
              '49165',
              '51579',
              '52134',
              '50573',
              '3024',
              '52461',
              '1223',
              '49371',
              '2369',
              '52275',
              '49098',
              '51268',
              '2466',
              '52279',
              '52566',
              '51968',
              '52589',
              '2422',
              '52318',
              '49428',
              '36918',
              '52571',
              '1553',
              '51508',
              '52312',
              '52495',
              '49198',
              '51281',
              '4620',
              '3108',
              '5642',
              '51744',
              '52557',
              '4354',
              '48928',
              '51529',
              '17430',
              '51004',
              '50492',
              '50618',
              '3427',
              '52189',
              '52123',
              '51952',
              '50653',
              '49803',
              '3311',
              '3000',
              '51415',
              '52350',
              '51689',
              '49589',
              '50125',
              '43899',
              '50407',
              '49329',
              '52477',
              '51144',
              '2163',
              '52452',
              '52394',
              '52218',
              '51647',
              '51565',
              '50660',
              '52393',
              '49141',
              '49087',
              '51561',
              '51425',
              '7073',
              '51699',
              '51902',
              '52072',
              '51423',
              '52381',
              '50930',
              '52551',
              '2025',
              '1232',
              '52256',
              '52253',
              '52252',
              '52407',
              '4601',
              '51858',
              '50354',
              '4988',
              '50852',
              '49283',
              '50042',
              '50595',
              '49072',
              '50830',
              '52130',
              '51775',
              '49788',
              '50570',
              '51639',
              '50869',
              '52177',
              '52183',
              '49743',
              '50905',
              '51305',
              '51939',
              '52499',
              '51248',
              '2492',
              '51758',
              '49050',
              '50989',
              '49276',
              '49696',
              '51578',
              '51436',
              '52484',
              '51055',
              '49370',
              '52587',
              '52172',
              '52578',
              '51658',
              '52287',
              '50319',
              '49858',
              '6927',
              '25350',
              '51761',
              '52197',
              '52300',
              '51523',
              '50902',
              '4366',
              '52349',
              '52497',
              '52016',
              '3046',
              '50876',
              '52149',
              '16389',
              '51915',
              '51398',
              '52235',
              '52145',
              '52240',
              '3841',
              '2054',
              '52140',
              '49043',
              '50692',
              '51260',
              '50631',
              '50120',
              '52242',
              '4590',
              '3208',
              '52423',
              '51723',
              '3560',
              '52351',
              '49334',
              '50919',
              '2680',
              '2742',
              '52444',
              '51573',
              '49583',
              '51164',
              '52075',
              '49056',
              '4059',
              '52536',
              '3232',
              '5840',
              '50990',
              '52472',
              '51103',
              '51752',
              '51188',
              '52109',
              '52171',
              '52132',
              '50853',
              '51413',
              '51242',
              '48971',
              '51730',
              '1241',
              '51206',
              '3992',
              '52013',
              '51823',
              '6419',
              '50444',
              '52466',
              '2609',
              '51064',
              '49189',
              '48958',
              '5886',
              '4403',
              '2049',
              '52335',
              '51829',
              '50528',
              '52434',
              '3118',
              '49105',
              '49453',
              '28196',
              '3010',
              '51986',
              '51625',
              '52490',
              '51356',
              '49673',
              '52107',
              '50408',
              '51460',
              '50284',
              '51127',
              '51479',
              '52221',
              '51261',
              '52325',
              '50842',
              '4739',
              '49084',
              '52135',
              '2339',
              '52498',
              '52590',
              '50494',
              '52294',
              '50612',
              '51994',
              '5401',
              '52247',
              '49822',
              '3222',
              '51088',
              '52479',
              '52361',
              '50911',
              '51581',
              '51931',
              '50280',
              '51930',
              '48979',
              '2485',
              '49996',
              '52529',
              '52494',
              '51439',
              '52345',
              '51885',
              '52426',
              '52425',
              '15718',
              '49204',
              '52441',
              '2999',
              '51870',
              '50844',
              '51331',
              '50906',
              '52439',
              '49000',
              '51661',
              '52324',
              '51900',
              '49218',
              '50872',
              '1792',
              '52382',
              '49782',
              '3811',
              '49197',
              '2924',
              '52470',
              '52121',
              '52293',
              '51729',
              '49732',
              '40110',
              '4044',
              '2629',
              '51286',
              '1668',
              '50873',
              '52031',
              '52095',
              '50345',
              '50748',
              '4217',
              '2469',
              '50736',
              '4982',
              '50847',
              '49172',
              '22129',
              '50591',
              '3092',
              '29693',
              '51563',
              '39059',
              '18135',
              '48991',
              '49291',
              '51899',
              '48985',
              '29318',
              '51158',
              '49460',
              '6459',
              '49312',
              '1197',
              '50525',
              '52533',
              '49267',
              '51875',
              '49976',
              '52225',
              '5665',
              '51718',
              '52086',
              '49477',
              '49855',
              '50558',
              '2122',
              '6963',
              '50703',
              '52463',
              '51365',
              '49559',
              '48999',
              '50955',
              '52378',
              '354',
              '51997',
              '52422',
              '6820',
              '50711',
              '50710',
              '52363',
              '49163',
              '50817',
              '50441',
              '49534',
              '49195',
              '49191',
              '51926',
              '50461',
              '2739',
              '51739',
              '4615',
              '51698',
              '1558',
              '41817',
              '48956',
              '2063',
              '4597',
              '49351',
              '49314',
              '2189',
              '52326',
              '50450',
              '52517',
              '51121',
              '20432',
              '5300',
              '6321',
              '2410',
              '52327',
              '49761',
              '49662',
              '52295',
              '6387',
              '49455',
              '51909',
              '49305',
              '52453',
              '2050',
              '52556',
              '2129',
              '51894',
              '51683',
              '50637',
              '52146',
              '4770',
              '1640',
              '3912',
              '52486',
              '49657',
              '3103',
              '2981',
              '49118',
              '52290',
              '1107',
              '52273',
              '1875',
              '50421',
              '50223',
              '5621',
              '6334',
              '49055',
              '52044',
              '49688',
              '51719',
              '6143',
              '52232',
              '52433',
              '6021',
              '17764',
              '50246',
              '49450',
              '51947',
              '2854',
              '7094',
              '51201',
              '50547',
              '2147',
              '51988',
              '7428',
              '1443',
              '49162',
              '51492',
              '52597',
              '5204',
              '52596',
              '2805',
              '49957',
              '51961',
              '49107',
              '49079',
              '51358',
              '49235',
              '6277',
              '52122',
              '52254',
              '4318',
              '52443',
              '1487',
              '50918',
              '49781',
              '1962',
              '50493',
              '2278',
              '4654',
              '52265',
              '52000',
              '52449',
              '51649',
              '49256',
              '51388',
              '5737',
              '49767',
              '52526',
              '48950',
              '48987',
              '49548',
              '50020',
              '48921',
              '52336',
              '51498',
              '2479',
              '52150',
              '52539',
              '52535',
              '52451',
              '51693',
              '51507',
              '52237',
              '50312',
              '52593',
              '5222',
              '52541',
              '52473',
              '52592',
              '52143',
              '52558',
              '52310',
              '52281',
              '52368',
              '52153',
              '51670',
              '51980',
              '51259',
              '52185',
              '52574',
              '52322',
              '52568',
              '51352',
              '52476',
              '52560',
              '52555',
              '52554',
              '2929',
              '52552',
              '51911',
              '52389',
              '52531',
              '49215',
              '2130',
              '51119',
              '49418',
              '52527',
              '52525',
              '52030',
              '52515',
              '52513',
              '52511',
              '52505',
              '52496',
              '52491',
              '52465',
              '52222',
              '52478',
              '52467',
              '52464',
              '51564',
              '52457',
              '52450',
              '52447',
              '52445',
              '52417',
              '51845',
              '52411',
              '52410',
              '52409',
              '52399',
              '52058',
              '52383',
              '52380',
              '52088',
              '52348',
              '52097',
              '52334',
              '52244',
              '51001',
              '52277',
              '52267',
              '52257',
              '51115',
              '52199',
              '51108',
              '52126',
              '2347',
              '52170',
              '52169',
              '13485',
              '52156',
              '52148',
              '52110',
              '1238',
              '1571',
              '52036',
              '50126',
              '51975',
              '51964',
              '51927',
              '51106',
              '2938',
              '51864',
              '50375',
              '51287',
              '51792',
              '51748',
              '51070',
              '51696',
              '51695',
              '49956',
              '51545',
              '51330',
              '51521',
              '51497',
              '51447',
              '51319',
              '51297',
              '51269',
              '51237',
              '49760',
              '51150',
              '51129',
              '49797',
              '50960',
              '50954',
              '2818',
              '50888',
              '50857',
              '50733',
              '50771',
              '50731',
              '50729',
              '50666',
              '50672',
              '50644',
              '50557',
              '50549',
              '50532',
              '50438',
              '49805',
              '1482',
              '40117',
              '50386',
              '50336',
              '50326',
              '50203',
              '50204',
              '50158',
              '50113',
              '50040',
              '50031',
              '49961',
              '49851',
              '49794',
              '49691',
              '2594',
              '49496',
              '49294',
              '49213',
              '49170',
              '49047',
              '49042',
              '49030',
              '48983',
              '48960',
              '7331',
              '23613',
              '3668',
              '2380',
              '1905',
              '7547',
              '6964',
              '3460',
              '3098',
              '3061',
              '1942',
              '1868',
              '52114',
              '52442',
              '49671',
              '49580',
              '50281',
              '50015',
              '49983',
              '51504',
              '50164',
              '48925',
              '51672',
              '3085',
              '51126',
              '51252',
              '49807',
              '6618',
              '42854',
              '50999',
              '52546',
              '49746',
              '50233',
              '51000',
              '51377',
              '49617',
              '3506',
              '50785',
              '49430',
              '49747',
              '5013',
              '51283',
              '51066',
              '52510',
              '50449',
              '52482',
              '50683',
              '52432',
              '51655',
              '51626',
              '3256',
              '51493',
              '3129',
              '51274',
              '52195',
              '52545',
              '52020',
              '51638',
              '52139',
              '51971',
              '49210',
              '50868',
              '50300',
              '41449',
              '52084',
              '49516',
              '4351',
              '51295',
              '51685',
              '51751',
              '51677',
              '50909',
              '51747',
              '51892',
              '49677',
              '49557',
              '51343',
              '51580',
              '51958',
              '52540',
              '51936',
              '49787',
              '50422',
              '29246',
              '52481',
              '52223',
              '52224',
              '50118',
              '49554',
              '51568',
              '49458',
              '7440',
              '49676',
              '52117',
              '51394',
              '3400',
              '50531',
              '51827',
              '52314',
              '51797',
              '2628',
              '51940',
              '51263',
              '49674',
              '49874',
              '52416',
              '52357',
              '49609',
              '50214',
              '49467',
              '51588',
              '51942',
              '50651',
              '50569',
              '52220',
              '49913',
              '52575',
              '51487',
              '52091',
              '49908',
              '50854',
              '51063',
              '51364',
              '52573',
              '49501',
              '51593',
              '51992',
              '49649',
              '51889',
              '49505',
              '49132',
              '51089',
              '50779',
              '49348',
              '52089',
              '48930',
              '49856',
              '51401',
              '49793',
              '3152',
              '50207',
              '51923',
              '52129',
              '49867',
              '3605',
              '6439',
              '51925',
              '52052',
              '3634',
              '49504',
              '52313',
              '49986',
              '51363',
              '50781',
              '50712',
              '49987',
              '50460',
              '52330',
              '2048',
              '50932',
              '49099',
              '49537',
              '52175',
              '49434',
              '50542',
              '50509',
              '52280',
              '52047',
              '52462',
              '52248',
              '51074',
              '52459',
              '52561',
              '52543',
              '52538',
              '52524',
              '52521',
              '52518',
              '52514',
              '52480',
              '52446',
              '50146',
              '52023',
              '52415',
              '52339',
              '52406',
              '52392',
              '52367',
              '52234',
              '52215',
              '52204',
              '52100',
              '52040',
              '51953',
              '51949',
              '51840',
              '51383',
              '51384',
              '51852',
              '51678',
              '51630',
              '50968',
              '51607',
              '50991',
              '51446',
              '51338',
              '51308',
              '51238',
              '51142',
              '50318',
              '51123',
              '5010',
              '51095',
              '51093',
              '51080',
              '51021',
              '51012',
              '50994',
              '50975',
              '50635',
              '50561',
              '50473',
              '50348',
              '50253',
              '50247',
              '50166',
              '50161',
              '50108',
              '49890',
              '49875',
              '49838',
              '49721',
              '49719',
              '49706',
              '49683',
              '49510',
              '49478',
              '49409',
              '6386',
              '3178',
              '51124',
              '52108',
              '49518',
              '50063',
              '51306',
              '6743',
              '52286',
              '51062',
              '50586',
              '49734',
              '50921',
              '51621',
              '50332',
              '3224',
              '50397',
              '3202',
              '49907',
              '50257',
              '48961',
              '52205',
              '5088',
              '52190',
              '51137',
              '52369',
              '50567',
              '51589',
              '52413',
              '50448',
              '49911',
              '51969',
              '52317',
              '51921',
              '52405',
              '52319',
              '7330',
              '49641',
              '51665',
              '50579',
              '51290',
              '50310',
              '50264',
              '50486',
              '49269',
              '52051',
              '52208',
              '52584',
              '52580',
              '52577',
              '52562',
              '52559',
              '52549',
              '52548',
              '52544',
              '52528',
              '52523',
              '52507',
              '52504',
              '52489',
              '52460',
              '52456',
              '52438',
              '52437',
              '52436',
              '52401',
              '52398',
              '52266',
              '52390',
              '52387',
              '52384',
              '52371',
              '52366',
              '52359',
              '52355',
              '52354',
              '51920',
              '52340',
              '52332',
              '52320',
              '52304',
              '52302',
              '52298',
              '52282',
              '52236',
              '52229',
              '52206',
              '52192',
              '52186',
              '52181',
              '52179',
              '52166',
              '52165',
              '52164',
              '52158',
              '51176',
              '52133',
              '52124',
              '52111',
              '52068',
              '52050',
              '52039',
              '52034',
              '52033',
              '52029',
              '52010',
              '52006',
              '51998',
              '51995',
              '51991',
              '51990',
              '51973',
              '51924',
              '51901',
              '51898',
              '51891',
              '51866',
              '51862',
              '51856',
              '51855',
              '51851',
              '51848',
              '51844',
              '51843',
              '51822',
              '51821',
              '51818',
              '51816',
              '51815',
              '51812',
              '51810',
              '51808',
              '51804',
              '51788',
              '51786',
              '51785',
              '51784',
              '51781',
              '51780',
              '51778',
              '51777',
              '51772',
              '51771',
              '51757',
              '51756',
              '51755',
              '51753',
              '51741',
              '51732',
              '51731',
              '51727',
              '51726',
              '51722',
              '51714',
              '51712',
              '51711',
              '51710',
              '51709',
              '51704',
              '51703',
              '51688',
              '51687',
              '51681',
              '51673',
              '51669',
              '51668',
              '51664',
              '51663',
              '51659',
              '51645',
              '51640',
              '51635',
              '51634',
              '51632',
              '51622',
              '51620',
              '51613',
              '51611',
              '51610',
              '51602',
              '51594',
              '51592',
              '51591',
              '51587',
              '51567',
              '51555',
              '51550',
              '51549',
              '51548',
              '51547',
              '51538',
              '51533',
              '51519',
              '51506',
              '51505',
              '51463',
              '51462',
              '51459',
              '51458',
              '51453',
              '51445',
              '51443',
              '51442',
              '51441',
              '51409',
              '51408',
              '51406',
              '51402',
              '51378',
              '51370',
              '51369',
              '51362',
              '51349',
              '51348',
              '51347',
              '51346',
              '51339',
              '51335',
              '51334',
              '51332',
              '51328',
              '51322',
              '51318',
              '51309',
              '51299',
              '51291',
              '51289',
              '51251',
              '51228',
              '51224',
              '51160',
              '51211',
              '51204',
              '51193',
              '51191',
              '51185',
              '51183',
              '51179',
              '51157',
              '51156',
              '51155',
              '51154',
              '51143',
              '51141',
              '51125',
              '51117',
              '51116',
              '51087',
              '51081',
              '51075',
              '51061',
              '51060',
              '51059',
              '51049',
              '51040',
              '51036',
              '51028',
              '51024',
              '51006',
              '50992',
              '50982',
              '50981',
              '50970',
              '50965',
              '50964',
              '50961',
              '50952',
              '50947',
              '50900',
              '50870',
              '50849',
              '50846',
              '50806',
              '50792',
              '50766',
              '50755',
              '50749',
              '50730',
              '50725',
              '50720',
              '50718',
              '50717',
              '50716',
              '50707',
              '50705',
              '50704',
              '50698',
              '50690',
              '50679',
              '50675',
              '50673',
              '50671',
              '50665',
              '50664',
              '50645',
              '50584',
              '50580',
              '50568',
              '50565',
              '50554',
              '50544',
              '50539',
              '50519',
              '50518',
              '50517',
              '50516',
              '50500',
              '50474',
              '50472',
              '50442',
              '50432',
              '50415',
              '50405',
              '50404',
              '50384',
              '50381',
              '50380',
              '50379',
              '50368',
              '50353',
              '50352',
              '50344',
              '50342',
              '50341',
              '50340',
              '50339',
              '50334',
              '50317',
              '50305',
              '50301',
              '50288',
              '50269',
              '50267',
              '50263',
              '50252',
              '50244',
              '50243',
              '50242',
              '50240',
              '50237',
              '50230',
              '50227',
              '50225',
              '50221',
              '50220',
              '50219',
              '50217',
              '50213',
              '50212',
              '50202',
              '50196',
              '50194',
              '50193',
              '50192',
              '50178',
              '50176',
              '50168',
              '50167',
              '50165',
              '50162',
              '50159',
              '50156',
              '50152',
              '50151',
              '50140',
              '50137',
              '50132',
              '50130',
              '50129',
              '49472',
              '50087',
              '50086',
              '50078',
              '50071',
              '50067',
              '50066',
              '50061',
              '50057',
              '50053',
              '50013',
              '49963',
              '49950',
              '49938',
              '49936',
              '49919',
              '49917',
              '49916',
              '49906',
              '49903',
              '49901',
              '49893',
              '49889',
              '49883',
              '49882',
              '49880',
              '49872',
              '49871',
              '49844',
              '49843',
              '49842',
              '49830',
              '49475',
              '49801',
              '49756',
              '49755',
              '49575',
              '49739',
              '49663',
              '49658',
              '49654',
              '49647',
              '49624',
              '49620',
              '49616',
              '49600',
              '49597',
              '49595',
              '49584',
              '49582',
              '49579',
              '49569',
              '49568',
              '49553',
              '49551',
              '49550',
              '49549',
              '49541',
              '49532',
              '49531',
              '49520',
              '49511',
              '49494',
              '49493',
              '49470',
              '49457',
              '49448',
              '49416',
              '49415',
              '49414',
              '49388',
              '49381',
              '49367',
              '49308',
              '49211',
              '49102',
              '20749',
              '7194',
              '5624',
              '4415',
              '3062',
              '3396',
              '3386',
              '3285',
              '3246',
              '3156',
              '3145',
              ]  # 여기에 wr_id들을 넣으세요


headers = {
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
    "Accept-Encoding": "gzip, deflate, br, zstd",
    "Accept-Language": "ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",
    "If-Modified-Since": "Wed, 16 Jul 2025 15:32:39 GMT",
    "Priority": "u=0, i",
    "Sec-Ch-Ua": '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"',
    "Sec-Ch-Ua-Mobile": "?0",
    "Sec-Ch-Ua-Platform": '"Windows"',
    "Sec-Fetch-Dest": "document",
    "Sec-Fetch-Mode": "navigate",
    "Sec-Fetch-Site": "none",
    "Sec-Fetch-User": "?1",
    "Upgrade-Insecure-Requests": "1",
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
}

base_url = "https://vipgunma.com/bbs/board.php?bo_table=gm_1&wr_id={}"

results = []

for wr_id in wr_id_list:
    url = base_url.format(wr_id)
    res = requests.get(url, headers=headers)
    if res.status_code != 200:
        print(f"[{wr_id}] 요청 실패: {res.status_code}")
        continue

    soup = BeautifulSoup(res.text, "html.parser")
    item = {"wr_id": wr_id}

    # 상호명
    store = soup.select_one(".storeName")
    item["상호명"] = store.text.strip() if store else ""

    # 조회수
    views = soup.select_one(".extra > div > span")
    item["조회수"] = views.text.strip().replace(",", "") if views else ""

    # 리뷰수
    # reviews = soup.select_one(".reviewCnt span")
    # item["리뷰수"] = reviews.text.strip() if reviews else ""
    reviews = fetch_review_count(wr_id)
    item["리뷰수"] = reviews


    # 샵특징
    shop_type = soup.select_one(".shopType")
    item["샵특징"] = shop_type.text.strip() if shop_type else ""

    # 상세정보
    detail_rows = soup.select(".content .detailRow")
    for row in detail_rows:
        head = row.select_one(".detailHead")
        con = row.select_one(".detailCon")
        if not head or not con:
            continue
        key = head.text.strip()
        if key == "오시는길":
            address_divs = con.select("div")
            item["지번주소"] = address_divs[0].text.strip() if len(address_divs) > 0 else ""
            item["도로명주소"] = address_divs[1].text.strip() if len(address_divs) > 1 else ""
        else:
            item[key] = con.text.strip()

    # 프로그램 정보
    programs = []
    program_blocks = soup.select(".programWrap")
    for block in program_blocks:
        title = block.select_one(".programHead")
        if not title:
            continue
        program_title = title.text.strip()
        rows = block.select(".itemRow")
        for row in rows:
            time_tag = row.select_one(".infoTxt")
            price_tags = row.select(".line2 .prc")
            price_tag = price_tags[1] if len(price_tags) > 1 else None
            if time_tag and price_tag:
                programs.append(f"{program_title} {time_tag.text.strip()} {price_tag.text.strip().replace(',', '')}")

    # ✅ 콤마로 연결해서 문자열로 저장
    item["programs"] = ", ".join(programs)

    # 결과 저장
    results.append(item)
    print(f"[{wr_id}] 수집 완료: {item['상호명']}")
    time.sleep(0.5)

# 프로그램은 문자열로 변환해서 엑셀에 저장
# for r in results:
#     r["programs"] = "\n".join([f"{p['program']} {p['time']} {p['price']}" for p in r["programs"]])

# 엑셀 저장
df = pd.DataFrame(results)
df.to_excel("vipgunma_detail.xlsx", index=False)

print("\n✅ 모든 데이터 수집 및 저장 완료: vipgunma_detail.xlsx")
